q
n
q
n
@provider
n
@provider.nil?
@provider
n
sorcery_get_provider
sorcer_get_provider
provider
step
n
params.permit(:code, :provider)
:code
step
auth_params[:provider]
auth_params[:google]
q
step
@user
user
login_from_session
@current_user
step
login_from_session
current_user
@current_user
step
current_user
!!current_user
step
n
user_class.load_from_provider(:google, @user_hash[:uid].to_s)
user_class.load_from_provider(:google, @user_has[:uid].to_s)
n
sorcery_fetch_user_hash :google
sorcery_fetch_user_hash google
sorcery_fetch_user_hash
sorcery_fetch_user_has
step
